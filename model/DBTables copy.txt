-- Drop all tables to ensure no errors;

DROP TABLE IF EXISTS "USER";
DROP TABLE IF EXISTS "PLAN";
DROP TABLE IF EXISTS "PROPERTY";
DROP TABLE IF EXISTS "PROP_AMORT";
DROP TABLE IF EXISTS "PLAN_AMORT";

-- User table is to contain multiple plans

CREATE TABLE "USER" (
	U_ID VARCHAR(50) NOT NULL,
	U_ID_CREATED TIMESTAMP NOT NULL DEFAULT NOW(),
	PL_ID VARCHAR(50) NOT NULL,
	CONSTRAINT PRIMARY KEY (U_ID)
);

-- Plan table is to contain multiple properties

CREATE TABLE "PLAN" (
	PL_ID VARCHAR(50) NOT NULL, -- User Created Plan ID 
	U_ID VARCHAR(50) NOT NULL,
	P_ID VARCHAR(50) NOT NULL, -- Calculated
	LOAN_START_DATE TIMESTAMP NOT NULL,
	LOAN_END_DATE TIMESTAMP NOT NULL, -- Calculated
	LOAN_LENGTH_YEAR VARCHAR(50) NOT NULL, 
	LOAN_PAY_PER_YEAR VARCHAR(50) NOT NULL,
	LOAN_NOM_INT_RATE VARCHAR(30) NOT NULL,
	LOAN_DOWNPAY VARCHAR(30) NOT NULL,
	MARKET_NOM_INT_RATE VARCHAR(30) NOT NULL,
	date_time_updated TIMESTAMP NOT NULL DEFAULT NOW(),
	expires_date TIMESTAMP NULL,
	CONSTRAINT attributes_pk PRIMARY KEY (id, attribute_name, attribute_value)
);

-- Property table is to contain all information to configure and calculate amortization schedule for a loan

CREATE TABLE "PROPERTY" (
	P_ID VARCHAR(50) NOT NULL, -- User Created Property ID 
	HOUSE_PRICE VARCHAR(50) NOT NULL,
	LOAN_AMOUNT VARCHAR(50) NOT NULL, -- Calculated
	LOAN_START_DATE TIMESTAMP NOT NULL,
	LOAN_END_DATE TIMESTAMP NOT NULL, -- Calculated
	LOAN_LENGTH_YEAR VARCHAR(50) NOT NULL, 
	LOAN_PAY_PER_YEAR VARCHAR(50) NOT NULL,
	LOAN_NOM_INT_RATE VARCHAR(30) NOT NULL,
	LOAN_DOWNPAY VARCHAR(30) NOT NULL,
	MARKET_NOM_INT_RATE VARCHAR(30) NOT NULL,
	date_time_updated TIMESTAMP NOT NULL DEFAULT NOW(),
	expires_date TIMESTAMP NULL,
	CONSTRAINT attributes_pk PRIMARY KEY (id, attribute_name, attribute_value)
);

-- Prop_amort table is to hold the amortization calculation generated by a configured property

CREATE TABLE "PROP_AMORT" (
	P_ID VARCHAR(50) NOT NULL, -- User Created Property ID 
	HOUSE_PRICE VARCHAR(50) NOT NULL,
	LOAN_AMOUNT VARCHAR(50) NOT NULL, -- Calculated
	LOAN_START_DATE TIMESTAMP NOT NULL,
	LOAN_END_DATE TIMESTAMP NOT NULL, -- Calculated
	LOAN_LENGTH_YEAR VARCHAR(50) NOT NULL, 
	LOAN_PAY_PER_YEAR VARCHAR(50) NOT NULL,
	LOAN_NOM_INT_RATE VARCHAR(30) NOT NULL,
	LOAN_DOWNPAY VARCHAR(30) NOT NULL,
	MARKET_NOM_INT_RATE VARCHAR(30) NOT NULL,
	date_time_updated TIMESTAMP NOT NULL DEFAULT NOW(),
	expires_date TIMESTAMP NULL,
	CONSTRAINT attributes_pk PRIMARY KEY (id, attribute_name, attribute_value)
);

-- Plan_amort table is to hold the amortization calculation of multiple configured properties

CREATE TABLE "PLAN_AMORT" (
	P_ID VARCHAR(50) NOT NULL, -- User Created Property ID 
	HOUSE_PRICE VARCHAR(50) NOT NULL,
	LOAN_AMOUNT VARCHAR(50) NOT NULL, -- Calculated
	LOAN_START_DATE TIMESTAMP NOT NULL,
	LOAN_END_DATE TIMESTAMP NOT NULL, -- Calculated
	LOAN_LENGTH_YEAR VARCHAR(50) NOT NULL, 
	LOAN_PAY_PER_YEAR VARCHAR(50) NOT NULL,
	LOAN_NOM_INT_RATE VARCHAR(30) NOT NULL,
	LOAN_DOWNPAY VARCHAR(30) NOT NULL,
	MARKET_NOM_INT_RATE VARCHAR(30) NOT NULL,
	date_time_updated TIMESTAMP NOT NULL DEFAULT NOW(),
	expires_date TIMESTAMP NULL,
	CONSTRAINT attributes_pk PRIMARY KEY (id, attribute_name, attribute_value)
);

